<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        /*
        * A窗口的域名是<http://example.com:8080>，以下是A窗口的script标签下的代码：
        */

        var popup = window.open('https://papaverice.github.io/html5-lesson4/message.html');
        

        // 如果弹出框没有被阻止且加载完成



        // 假设当前页面没有改变location，这条语句会成功添加message到发送队列中去（targetOrigin设置对了）
        popup.postMessage("hello there!", "https://papaverice.github.io/html5-lesson4/message.html");

        function receiveMessage(event)
        {
        // 我们能相信信息的发送者吗?  (也许这个发送者和我们最初打开的不是同一个页面).
        if (event.origin !== "https://papaverice.github.io")
            return;

        // event.source 是我们通过window.open打开的弹出页面 popup
        // event.data 是 popup发送给当前页面的消息 "hi there yourself!  the secret response is: rheeeeet!"
        }
        window.addEventListener("message", receiveMessage, false);
            
    </script>
</body>
</html>